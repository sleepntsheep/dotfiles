#!/bin/sh

ctheme=`cat ~/.local/bin/theme`

#rm ~/.config/BetterDiscord/themes/gruvbox.theme.css

if [ "$ctheme" = "dark" ]
then
    # Neovim
    sed -i 's/background = "dark"/background = "light"/g' ~/.config/nvim/lua/options/init.lua
    # Alacritty
    cp ~/.config/alacritty/gruvbox-light.yml ~/.config/alacritty/alacritty.yml
    # Polybar
    cp ~/.config/polybar/gruvbox-light.ini ~/.config/polybar/colors.ini
    # Rofi
    sed -i "s/gruvbox-dark/gruvbox-light/g" ~/.config/rofi/config.rasi
    # Dunst
    cp ~/.config/dunst/gruvbox-light ~/.config/dunst/dunstrc
    # Code
    sed -i "s/Gruvbox Material Dark/Gruvbox Material Light/g" ~/.config/Code\ -\ OSS/User/settings.json
    # Betterdiscord
    cat ~/.config/BetterDiscord/themes/gruvbox-light.css >| ~/.config/BetterDiscord/themes/gruvbox.theme.css
    # Notify
    notify-send "Switched theme to gruvbox light" -t 3000
    # Store current theme
    echo "light" >| ~/.local/bin/theme

elif [ "$ctheme" = "light" ]
then
    # Neovim
    sed -i 's/background = "light"/background = "dark"/g' ~/.config/nvim/lua/options/init.lua
    # Alacritty
    cp ~/.config/alacritty/gruvbox-dark.yml ~/.config/alacritty/alacritty.yml
    # Polybar
    cp ~/.config/polybar/gruvbox-dark.ini ~/.config/polybar/colors.ini
    # Rofi
    sed -i "s/gruvbox-light/gruvbox-dark/g" ~/.config/rofi/config.rasi
    # Dunst
    cp ~/.config/dunst/gruvbox-dark ~/.config/dunst/dunstrc
    # Code
    sed -i "s/Gruvbox Material Light/Gruvbox Material Dark/g" ~/.config/Code\ -\ OSS/User/settings.json
    cat ~/.config/BetterDiscord/themes/gruvbox-dark.css >| ~/.config/BetterDiscord/themes/gruvbox.theme.css
    notify-send "Switched theme to gruvbox light"
    echo "dark" >| ~/.local/bin/theme
fi

pkill dunst
pkill polybar

# nvim -c "luafile %"
# trying to figure out how to reload nvim config

~/.config/polybar/launch.sh &
